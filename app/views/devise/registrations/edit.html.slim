= content_for :title, '–ü—Ä–æ—Ñ–∏–ª—å'

.flex.items-center.gap-3.mb-4
  .w-7.h-7.rounded-full.overflow-hidden.flex-shrink-0.flex.items-center.justify-center.profile-avatar
    - if current_user.photo_url.present?
      = image_tag current_user.photo_url
    - else
      = render IconComponent.new name: :profile
  h2 class="!mb-0" –ü—Ä–∏–≤–µ—Ç, #{current_user.first_name || current_user.first_name_raw} üëã

.bonus-block
  .p-5
    .flex.justify-between data-controller="modal"
      div
        div –í–∞—à –±–∞–ª–∞–Ω—Å
        .bonus-balance #{format_price current_user.bonus_balance}
      .account-tier data-action="click->modal#openTier"
        div = current_user.account_tier&.title || '–ì–æ—Å—Ç—å'
        = render IconComponent.new name: :info, size: 16
      .modal-account-tier data-modal-target="modal" data-action="click->modal#closeModal"
        .modal-wrapper
          .modal-title
            span.font-semibold –£—Ä–æ–≤–Ω–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
            .close data-action="click->modal#close"
              = render IconComponent.new name: :close
          .modal-body
            - AccountTier.all.each do |item|
              .flex.flex-wrap.py-2
                .w-1/2.pe-1.title = item.title
                .w-1/2.desc
                  .mb-2 #{item.bonus_percentage}% –∫—ç—à–±—ç–∫–∞
                  div
                    - if item.order_threshold == 1
                      | –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–∫–∞–∑–µ
                    - else
                      | –ó–∞–∫–∞–∑–æ–≤ –Ω–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å ‚Äì #{item.order_threshold}
          .mt-1.font-medium class="text-[10px]" –ë–æ–Ω—É—Å—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –ø—Ä–∏ –∑–∞–∫–∞–∑–∞—Ö –æ—Ç #{format_price Setting.fetch_value(:bonus_threshold)}
  .bonus-block-footer
    - left = remaining_to_next_tier
    - if left.is_a? Integer
      .flex.justify-between.mb-2.gap-1
        - total = current_user.next_account_tier&.order_threshold
        - [*1..total].each do |i|
          .h-1.bg-white.rounded style="width: #{100 / left}%" class="#{'!bg-white/40' if i > (total - left)}"
      div = t('orders_to_next_level', count: left)
    - else
      div –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è

.main-block.mb-5.user-links
  = link_to product_subscriptions_path, class: "btn btn-big btn-secondary flex justify-between mb-2 items-center", data: { turbo_prefetch: false } do
    .flex.justify-center.gap-2.items-center
      = render IconComponent.new name: :clock
      span –¢–æ–≤–∞—Ä—ã –≤ –æ–∂–∏–¥–∞–Ω–∏–∏
    .right-arrow
      = render IconComponent.new name: :right
  = link_to orders_path, class: 'btn btn-big btn-secondary flex justify-between items-center', data: { turbo_prefetch: false } do
    .flex.justify-center.gap-2.items-center
      = render IconComponent.new name: :cart2
      span  –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤
    .right-arrow
      = render IconComponent.new name: :right
  - if current_user.admin_or_moderator_or_manager?
    a.btn.btn-big.btn-secondary.flex.justify-between.items-center.mt-2 class="!bg-red-100/70 hover:!bg-red-300/50 !text-red-500" href="/admin" data-turbo="false"
      .flex.justify-center.gap-2.items-center
        = render IconComponent.new name: :admin
        span  –ê–¥–º–∏–Ω–∫–∞
      .right-arrow
        = render IconComponent.new name: :right

= render '/devise/registrations/edit'
