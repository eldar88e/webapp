<%= form_with(model: @order, url: admin_order_path(@order), class: 'admin-form') do |form| %>
  <div class="mb-5">
    <%= form.label :user %>
    <%= form.text_field :user, disabled: true, value: @order.user.full_name %>
  </div>

  <div class="mb-5">
    <%= form.label :tracking_number %>
    <%= form.text_field :tracking_number %>
  </div>

  <div class="flex flex-wrap -mx-1.5">
    <div class="mb-5 w-full sm:w-2/3 px-1.5">
      <%= form.label :status %>
      <% statuses = Order.statuses.except('initialized').map { |key, _| [I18n.t("order.statuses.#{key}"), key] } %>
      <%= form.select :status, statuses, {} %>
    </div>
    <div class="mb-5 w-full sm:w-1/3 px-1.5">
      <%= form.label :updated_at %>
      <%= form.text_field :updated_at, disabled: true, value: format_date(@order.updated_at) %>
    </div>
  </div>

  <div class="mb-5">
    <%= form.label :bank_card %>
    <% if @order.status == 'unpaid' %>
      <% bank_config = { selected: @order.bank_card_id }  %>
      <% bank_config = { include_blank: 'Не выбрано' } if @order.bank_card.nil? %>
      <%= form.select :bank_card, BankCard.active.map { |i| [i.bank_details_admin, i.id] }, bank_config  %>
    <% else %>
      <% card = @order.bank_card.present? ? @order.bank_card.bank_details_admin : 'Не выбрано' %>
      <%= form.text_field :bank_card, disabled: true, value: card %>
    <% end %>
  </div>

  <div class="mb-5 flex justify-between items-center">
    <div class="text-gray-900 dark:text-white">
      Курс: <%= @order.exchange_rate %>
    </div>
    <div class="flex items-center gap-3">
      <%= button_to admin_order_path, method: :delete, class: 'btn btn-danger',
                    data: { confirm: 'Вы уверены, что хотите удалить данный заказ?',
                            controller: 'confirm', action: 'click->confirm#call' } do %>
        <%= render Admin::IconComponent.new name: :trash %>
      <% end %>
      <%= form.submit "Сохранить", data: { action: "click->modal#close" }, class: 'btn' %>
    </div>
  </div>
<% end %>
