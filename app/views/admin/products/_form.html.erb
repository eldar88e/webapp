<%= form_with model: product, url: (method == :patch ? admin_product_path(product) : admin_products_path),
              data: { action: 'submit->modal#close' }, class: 'admin-form' do |form| %>
  <div class="mb-5">
    <%= form.label :name %>
    <%= form.text_field :name %>
  </div>

  <div class="mb-5">
    <%= form.label :ancestry %>
    <% root = Product.find_by(id: Setting.fetch_value(:root_product_id)) %>
    <% select = [['Без категории', '']] %>
    <% select += [[root.name, root.id]] + root.children.map { |item| [item.name, "#{item.parent.id}/#{item.id}"] } if root %>
    <% select += Product.all.map { |item| [item.name, item.id] } unless root %>
    <%= form.select :ancestry, select, {} %>
  </div>

  <div class="mb-5">
    <%= form.label :image %>
    <%= form.file_field :image, accept: 'image/jpeg,image/png,image/webp' %>
  </div>

  <div class="flex gap-4">
    <div class="w-1/3">
      <div class="mb-5">
        <%= form.label :price %>
        <%= form.number_field :price, min: 0 %>
      </div>
    </div>

    <div class="w-1/3">
      <div class="mb-5">
        <%= form.label :old_price %>
        <%= form.number_field :old_price, min: 0 %>
      </div>
    </div>

    <div class="w-1/3">
      <div class="mb-5">
        <%= form.label :stock_quantity %>
        <%= form.number_field :stock_quantity, min: 0 %>
      </div>
    </div>
  </div>

  <div class="mb-5">
    <%= form.label :description %>
    <%= form.text_area :description %>
  </div>

  <div class="flex gap-4">
    <div class="w-1/2">
      <div class="mb-5">
        <%= form.label :weight %>
        <%= form.text_field :weight %>
      </div>
    </div>

    <div class="w-1/2">
      <div class="mb-5">
        <%= form.label :package_quantity %>
        <%= form.number_field :package_quantity, min: 0 %>
      </div>
    </div>
  </div>

  <div class="flex gap-4">
    <div class="w-1/2">
      <div class="mb-5">
        <%= form.label :dosage_form %>
        <%= form.text_field :dosage_form %>
      </div>
    </div>

    <div class="w-1/2">
      <div class="mb-5">
        <%= form.label :brand %>
        <%= form.text_field :brand %>
      </div>
    </div>
  </div>

  <div class="mb-5">
    <%= form.label :main_ingredient %>
    <%= form.text_field :main_ingredient %>
  </div>

  <%= form.submit 'Сохранить', class: 'btn' %>
<% end %>
